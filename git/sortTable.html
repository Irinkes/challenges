<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <style>
            table {
                border-spacing: 0;
            }
            thead tr:first-child{
                background: #ccc;
            }
            td, th{
                border:1px solid #000;
                padding: 5px;
            }
            .sort-btn{
                width: 0;
                height: 0;
                border-left: 10px solid transparent;
                border-right: 10px solid transparent;
                margin-left:10px;
                margin-right:10px;
                position: relative;
                cursor: pointer;
            }
            .sort-btn-down {
                border-top: 10px solid red;
                bottom: -15px;
            }
            .sort-btn-up {
                border-bottom: 10px solid red;
                bottom: 13px;
            }
            .add-btn {
                background: url("add.ico");
                width: 20px;
                height: 20px;
                background-size: 100%;
                margin-top: 10px;
            }
            .add-btn:hover {
                width: 25px;
                height: 25px;
                cursor: pointer;
            }
            .inputs {
                margin-top:10px;
                display: none;
            }
        </style>
    </head>
    <body>
        <table id="table">
            <thead>
                <tr>
                    <th>Name<span class="sort-btn sort-btn-up" id="names-col" data-type="abc"></span></th>
                    <th>Job title<span class=" sort-btn sort-btn-up" id="jobtitle-col" data-type="abc"></span></th>
                    <th>Age<span class="sort-btn sort-btn-up" data-type="num" id="age-col"></span></th>
                    <th>Married<span class="sort-btn sort-btn-up" data-type="abc" id="married-col"></span></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="name">Mark</td>
                    <td class="job">Javascript programmer</td>
                    <td>18</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td class="name">Leo</td>
                    <td class="job">Full-stack developer</td>
                    <td >16</td>
                    <td>No</td>
                </tr>
                <tr>
                    <td class="name">Kiera</td>
                    <td class="job">Marketing sales manager</td>
                    <td>38</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td class="name">Natasha</td>
                    <td class="job">HR manager</td>
                    <td>25</td>
                    <td>No</td>
                </tr>
                <tr>
                    <td class="name">Sonya</td>
                    <td class="job">Financial director</td>
                    <td>29</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td class="name">Kevin</td>
                    <td class="job">Electrician</td>
                    <td>30</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td class="name">Victoria</td>
                    <td class="job">HR manager</td>
                    <td>19</td>
                    <td>No</td>
                </tr>
                <tr>
                    <td class="name">Thomas</td>
                    <td class="job">Head of Marketing department</td>
                    <td>39</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td class="name">Elizabeth</td>
                    <td class="job">Backend developer</td>
                    <td>50</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td class="name">Moreen</td>
                    <td class="job">Pizzamaker</td>
                    <td>16</td>
                    <td>No</td>
                </tr>
            </tbody>
        </table>
        <div class="inputs" id="inputs">
            <input type="text" placeholder="Name" name="name" />
            <input type="text" placeholder="Job title" name="jobtitle"/>
            <input type="text" placeholder="Age" name="age"/>
            <input type="text" placeholder="Married?" name="married"/>
        </div>
        <div class="add-btn" id="addbtn"></div>
        <script>

            function sortColumns(){
                var tbody = table.getElementsByTagName('tbody')[0];
                var rowArray = [].slice.call(tbody.rows);
                var compareRows;

                if(event.target.tagName!=='TH' && event.target.tagName!=='SPAN'){
                        return;
                }
                else {
                    var cellindex;
                    var target;
                    console.log(event.target.tagName);
                    var attr = event.target.getAttribute('data-type');
                    if(event.target.tagName==='TH') {
                        cellindex = event.target.cellIndex;
                        sortColHeader = event.target.firstChild;
                    }
                    else if(event.target.tagName==='SPAN') {
                        cellindex = event.target.parentNode.cellIndex;
                        sortColHeader = event.target;

                    }
                    console.log(sortColHeader);


                    if(attr==='abc'){
                        compareRows = function (rowA, rowB) {
                            return rowA.cells[cellindex].innerHTML > rowB.cells[cellindex].innerHTML;
                        }
                    }
                    else if(attr==='num'){
                        compareRows = function (rowA, rowB) {
                            return rowA.cells[sortColHeader.parentNode.cellIndex].innerHTML - rowB.cells[sortColHeader.parentNode.cellIndex].innerHTML;
                        }
                    }

                    if(!(sortColHeader.classList.contains('sort-btn-down'))) {

                        rowArray = rowArray.sort(compareRows);
                        table.removeChild(tbody);
                        for(i=0;i<rowArray.length;i++) {
                            tbody.appendChild(rowArray[i]);
                        }
                        table.appendChild(tbody);
                        sortColHeader.classList.remove('sort-btn-up');
                        sortColHeader.classList.add('sort-btn-down');

                    }
                    else {
                        rowArray = rowArray.reverse();
                        table.removeChild(tbody);
                        for(i=0;i<rowArray.length;i++) {
                            tbody.appendChild(rowArray[i]);
                        }
                        table.appendChild(tbody)
                        sortColHeader.classList.remove('sort-btn-down');
                        sortColHeader.classList.add('sort-btn-up');
                    }
                }

            }
            function addRow(){
                var addbtn = document.querySelector("#addbtn");
                var inputs = document.querySelector("#inputs");

                if(!(addbtn.classList.contains('addToTable'))) {
                    inputs.style.display='block';
                    addbtn.classList.add('addToTable');
                }
                else {
                    var tbody = table.getElementsByTagName('tbody')[0];
                    var inputValues=[];
                    for(i=0; i<inputs.getElementsByTagName('input').length;i++) {
                        inputValues[i] = inputs.getElementsByTagName('input')[i].value;
                    }

                    var tr = document.createElement('tr');
                    var newtd = [];
                    console.log(inputs.getElementsByTagName('input').length);
                    for(i=0;i<inputs.getElementsByTagName('input').length;i++) {
                        newtd[i]=document.createElement('td');
                        newtd[i].innerHTML = inputValues[i];
                        tr.appendChild(newtd[i]);
                    }
                    tbody.appendChild(tr);

                    for(i=0;i<inputs.getElementsByTagName('input').length;i++) {
                        inputs.getElementsByTagName('input')[i].value='';
                    }
                }
            }
            table.addEventListener('click',sortColumns);
            addbtn.addEventListener('click',addRow);
//


        </script>
    </body>
</html>